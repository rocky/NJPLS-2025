<h1>Decompiling to get more Precise Position Information</h1>
<section>
  <div align="left">
    <p>
      <div class="asciicast">
	<!--
	    {
	    "URL": "cast/divide-example.cast",
	    "idle_time_limit": 0.5,
	    "font-size": "18px",
	    "theme": "solarized-light",
	    "start":12,
	    "speed":1.5,
	    "poster": "npt:1:23"
	    }
	  -->
      </div>
    </p>
  </div>
  <aside class="notes">
    <font size="3.0em">
      <p>
	Can anything be done to get more accurate position numbers in
	those programming languages that only report line numbers, like
	Perl or the versions of Python for the first 25 years? Actually,
	yes.
      </p>


      <p>
	What I have done for both of these, is write a
	decompiler. This starts out with the code produced and
	reconstructs source code. This is easier done when high-level
	bytecode is involved as in the case of Python, or where the
	interpretation is done on a tree structure which happens in
	Perl5 and Korn Shell.
      </p>

      <p>After writing the decompiler, I then hooked this into a gdb-like debugger.
      </p>

      <p>First, I show the source text. It is what we had before, an
      expression with two divisions that raises a *ZeroDivision* error
      when run. When I run it using Python, not only do we get just
      the line number, but we get the *wrong* line number! This has
	been fixed though in Python 3.13.
      </p>

      <p>
      I run it under a debugger I wrote, called <i>trepan3k</i> so
      that when there is an error, it goes into the debugger's
      post-mortem handling. In that, there is a `deparse` command
      which takes deparses the program. For this it uses a grammar and
      builds a parse tree and from the instructions. Based on this
      parse tree, we can associate a range of source text.
      </p>

      <p>
	The <i>--parent</i> option is just showing the parent text in
	addition to the text associated with the instruction.
      </p>

      <p>
	Previously we mentioned that containers are heirarchical. But
	here, we see that locations *inside* containers can also be
	thought of as being heirarchical in the sense of its parse
	tree.
      </p>

      <p>I have glossed over a lot of detail here, the last slide has
      links for more information and detail.</p>

    </font>
  </aside>
</section>
